<% col_size ||= 12 %>
<%
    hide_show_btn ||= false
    params[:force_units] = investment_opportunity.default_currency_units
%>

<div class="col-md-4 mb-4">
    <div class="investment-opportunity-card">
        <div class="card-header-custom">
            <div class="company-info">
                <h3 class="company-title">
                    <%= link_to investment_opportunity.company_name, investment_opportunity %>
                </h3>
            </div>
            <% if investment_opportunity.logo.present? %>
                <%= image_tag investment_opportunity.logo.url(expires_in: 60*60*24*7), class: "company-logo" %>
            <% end %>
        </div>

        <div class="card-body-custom">
            <!-- Hero Metric -->
            <div class="hero-metric">
                <div class="icon-box">
                    <i class="ti ti-currency-dollar"></i>
                </div>
                <div class="content">
                    <span class="label">Fund Raise</span>
                    <span class="value"><%= money_to_currency investment_opportunity.fund_raise_amount, params %></span>
                </div>
            </div>

            <%
                if params[:force_units] == "Crores" && investment_opportunity.min_ticket_size.to_d < 100_00000
                    # If committed_amount is less than a crore, then show in lakhs
                    params[:force_units] = "Lakhs"
                end
            %>

            <!-- Secondary Metrics Grid -->
            <div class="secondary-metrics">
                <div class="metric-item">
                    <div class="icon-label">
                        <i class="ti ti-ticket ticket-icon"></i>
                        <span>Min Ticket</span>
                    </div>
                    <span class="value"><%= money_to_currency investment_opportunity.min_ticket_size, params %></span>
                </div>

                <div class="metric-item">
                    <div class="icon-label">
                        <i class="ti ti-calendar date-icon"></i>
                        <span>Closes On</span>
                    </div>
                    <span class="value"><%= l investment_opportunity.last_date %></span>
                </div>
            </div>

            <!-- Tags -->
            <% if show_tags %>
                <% tags = investment_opportunity.tag_list&.split(",") %>
                <% if tags.present? %>
                    <div class="tags-section">
                        <% tags.each do |tag| %>
                            <%= link_to tag, investment_opportunities_path(tag:), class: "custom-badge" %>
                        <% end %>
                    </div>
                <% end %>
            <% end %>
        </div>

        <% unless hide_show_btn %>
            <div class="action-footer">
                <% link = policy(investment_opportunity).update? ? investment_opportunity_path(investment_opportunity) : investment_opportunity_path(investment_opportunity, preview: true) %>
                <%= link_to link, class: "btn btn-view-opportunity" do %>
                    <span><%= t_common(:show) %></span>
                    <i class="ti ti-arrow-right"></i>
                <% end %>
            </div>
        <% end %>
    </div>
</div>

<% params[:force_units] = nil %>