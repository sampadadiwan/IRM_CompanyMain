<% display_type ||= "card" %>
<% cards = [
  {
    icon: "ti ti-chart-histogram",
    value: investor.support_agent_report.json_fields["kpi_issues"].filter { |issue| issue["severity"] == "blocking" }.size,
    type: :numeric,
    subtitle: "Missing KPIs"
  },
  {
    icon: "ti ti-device-analytics",
    value: investor.support_agent_report.json_fields["valuation_issues"].filter { |issue| issue["severity"] == "blocking" }.size,
    type: :numeric,
    subtitle: "Missing Valuations"
  },
  {
    icon: "ti ti-files",
    value: investor.support_agent_report.json_fields["document_issues"]&.count { |doc| doc["type"] == "missing" },
    type: :numeric,
    subtitle: "Missing Documents"
  },
] %>

<%= render partial: "/support_agents/report", locals: { cards:, owner: investor, display_type: } %>
