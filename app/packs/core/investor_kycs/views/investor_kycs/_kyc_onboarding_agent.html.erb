<%
  return if investor_kyc.support_agent_report.blank?
  display_type ||= "card"
%>
<div class="row g-3 mb-3">
<% cards = [
  {
    icon: "ti ti-notes",
    value: investor_kyc.support_agent_report.json_fields["field_issues"]&.size,
    type: :numeric,
    subtitle: "Missing Fields"
  },
  {
    icon: "ti ti-files",
    value: investor_kyc.support_agent_report.json_fields["document_issues"]&.count { |doc| doc["type"] == "missing" },
    type: :numeric,
    subtitle: "Missing Docs"
  },
  {
    icon: "ti ti-files",
    value: investor_kyc.support_agent_report.json_fields["document_issues"]&.count { |doc| doc["type"] == "mismatched_document" },
    type: :numeric,
    subtitle: "Invalid Docs"
  },
  {
    icon: "ti ti-cancel",
    value: investor_kyc.support_agent_report.json_fields["document_issues"]&.count { |doc| doc["type"] == "field_mismatch" },
    type: :numeric,
    subtitle: "Mismatched"
  },
  {
    icon: "ti ti-shield-check",
    value: investor_kyc.aml_reports.present? ? "Yes" : "No",
    date: investor_kyc.aml_reports&.last&.created_at,
    type: :boolean,
    subtitle: "AML Report"
  }
] %>

<%= render partial: "/support_agents/report", locals: { cards:, owner: investor_kyc, display_type:  } %>