wb = xlsx_package.workbook

wb.add_worksheet(name: "Agent Charts") do |sheet|
  # Create the header row
  sheet.add_row(["Title", "Status", "Prompt", "Document Ids", "Error"])

  # Create entries for each item
  @agent_charts.each do |chart|
    sheet.add_row [chart.title, chart.status, chart.prompt, chart.document_ids&.join(","), chart.error]
  end
end
